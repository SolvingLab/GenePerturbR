% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment.R
\name{gpdb_enrich}
\alias{gpdb_enrich}
\title{Over-Representation Analysis for Gene Perturbation Results}
\usage{
gpdb_enrich(
  targets,
  enrich.type = c("GO", "KEGG", "Wiki", "Reactome", "MsigDB", "Mesh", "HgDisease",
    "Enrichrdb", "Self"),
  organism = "hs",
  filter.pcg = TRUE,
  min.genes = 10,
  split.by = c("auto", "direction", "none"),
  top_up = NULL,
  top_down = NULL,
  p.cutoff = 0.05,
  q.cutoff = 0.05,
  background.genes = NULL,
  GO.ont = "bp",
  KEGG.category = "pathway",
  Msigdb.category = "H",
  return.all = TRUE,
  ...
)
}
\arguments{
\item{targets}{Either:
\itemize{
  \item A gpdb_find_targets result (list with $upregulated and $downregulated)
  \item A named list with $up and $down gene vectors
  \item A character vector of gene symbols (will analyze as single list)
}}

\item{enrich.type}{Character. Database to use:
"GO", "KEGG", "Wiki", "Reactome", "MsigDB", "Mesh", "HgDisease", "Enrichrdb", "Self"}

\item{organism}{Character. "hs" (human), "mm" (mouse), etc. Default "hs"}

\item{filter.pcg}{Logical. Filter to protein-coding genes only (default TRUE).
Recommended to enable for accurate enrichment as most databases (GO/KEGG) primarily annotate PCGs.}

\item{min.genes}{Integer. Minimum genes required after filtering (default 10, warns if below)}

\item{split.by}{Character. How to split genes:
\itemize{
  \item "auto": Automatically detect structure (default)
  \item "direction": Separate up/down regulated genes
  \item "none": Analyze all genes together
}}

\item{top_up}{Integer. Number of top upregulated genes to analyze (default: all)}

\item{top_down}{Integer. Number of top downregulated genes to analyze (default: all)}

\item{p.cutoff}{Numeric. P-value cutoff for significance (default 0.05)}

\item{q.cutoff}{Numeric. Q-value cutoff for significance (default 0.05)}

\item{background.genes}{Character vector. Background genes (default: NULL, uses database genes)}

\item{GO.ont}{Character. GO ontology: "bp", "cc", "mf", or "all" (default "bp")}

\item{KEGG.category}{Character. KEGG category (default "pathway")}

\item{Msigdb.category}{Character. MSigDB category (default "H" for Hallmark)}

\item{return.all}{Logical. Return all pathways or only significant ones (default TRUE)}

\item{...}{Additional arguments passed to underlying enrichment functions}
}
\value{
A list containing:
  \itemize{
    \item upregulated: ORA results for upregulated genes (list with $All and $Sig)
    \item downregulated: ORA results for downregulated genes (list with $All and $Sig)
    \item params: Parameters used for the analysis
  }
}
\description{
Perform enrichment analysis on upregulated and downregulated genes separately.
Supports multiple enrichment databases and returns both significant and non-significant results.
}
\examples{
\dontrun{
# From gpdb_find_targets result
targets <- gpdb_find_targets("TP53", top_n = 100)
enrich_res <- gpdb_enrich(targets, enrich.type = "GO")

# From gene list
genes <- c("MYC", "TP53", "KRAS", "EGFR")
enrich_res <- gpdb_enrich(genes, enrich.type = "KEGG", split.by = "none")

# Custom gene lists
gene_lists <- list(
  up = c("MYC", "CCND1", "CDK4"),
  down = c("TP53", "RB1", "CDKN1A")
)
enrich_res <- gpdb_enrich(gene_lists, enrich.type = "GO")
}
}
